<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<title>Controller</title>
		<link rel="stylesheet" type="text/css" href="./css/controller.css" />
		<script defer>
			function Queue() {
				let queue = [],
					offset = 0;
				this.getLength = () => queue.length - offset;
				this.isEmpty = () => this.getLength() === 0;
				this.enqueue = (item) => queue.push(item);
				this.dequeue = () => {
					if (this.isEmpty()) return undefined;
					const item = queue[offset++];
					if (offset * 2 >= queue.length) {
						queue = queue.slice(offset);
						offset = 0;
					}
					return item;
				};
				this.peek = () => (this.isEmpty() ? undefined : queue[offset]);
			}
		</script>
		<script src="./js/_jquery1102.min.js" defer></script>
		<script src="./js/controller.gamepad.js" defer></script>
		<script src="./js/controller.tester.js" defer></script>
		<script src="./js/controller.js" defer></script>
	</head>
	<body>
		<div class="container" id="gamepads">
			<div class="template">
				<div class="plshalpme">
					<div><p>Disconnected</p></div>
				</div>
				<div class="triggers">
					<span class="trigger left" data-name="button-left-shoulder-bottom"></span>
					<span class="trigger right" data-name="button-right-shoulder-bottom"></span>
					<span class="trigger-button left" data-name="button-left-shoulder-bottom-digital"></span>
					<span class="trigger-button right" data-name="button-right-shoulder-bottom-digital"></span>
					<span class="clear"></span>
				</div>
				<div class="bumpers">
					<span class="bumper left" data-name="button-left-shoulder-top"></span>
					<span class="bumper right" data-name="button-right-shoulder-top"></span>
					<span class="clear"></span>
				</div>
				<div class="touchpad" data-name="touch-pad"></div>
				<div class="quadrant"></div>
				<div class="meta" data-name="button-meta"></div>
				<div class="arrows">
					<span class="back" data-name="button-select"></span>
					<span class="start" data-name="button-start"></span>
					<span class="clear"></span>
				</div>
				<div class="abxy">
					<span class="button a" data-name="button-1"></span>
					<span class="button b" data-name="button-2"></span>
					<span class="button x" data-name="button-3"></span>
					<span class="button y" data-name="button-4"></span>
				</div>
				<div class="sticks">
					<span class="stick left" data-name="stick-1"></span>
					<span class="stick right" data-name="stick-2"></span>
				</div>
				<div class="wheels">
					<span class="wheel left" data-name="stick-1-wheel"></span>
					<span class="wheel right" data-name="stick-2-wheel"></span>
				</div>
				<div class="dpad">
					<span class="face up" data-name="button-dpad-top"></span>
					<span class="face down" data-name="button-dpad-bottom"></span>
					<span class="face left" data-name="button-dpad-left"></span>
					<span class="face right" data-name="button-dpad-right"></span>
				</div>
				<div class="fstick" data-name="arcade-stick"></div>
			</div>
			<div class="controller xbox disconnected" id="gamepad-0"></div>
			<div class="controller xbox disconnected" id="gamepad-1"></div>
			<div class="controller xbox disconnected" id="gamepad-2"></div>
			<div class="controller xbox disconnected" id="gamepad-3"></div>
		</div>
		<div class="navbar hide-me">
			<div class="content">
				<div class="left">
					<a href="#menu"><i class="fa fa-bars menu-button"></i></a>
				</div>
				<div class="center pselect">
					<div class="left">
						<span>Currently Viewing: </span>
						<select class="player">
							<option>None</option>
							<option value="gamepad-0">Player 1</option>
							<option value="gamepad-1">Player 2</option>
							<option value="gamepad-2">Player 3</option>
							<option value="gamepad-3">Player 4</option>
						</select>
					</div>
				</div>
			</div>
		</div>
		<div class="navbar nocon hide-me">
			<div class="content">
				<div class="left">
					<ul>
						<li class="box alert">
							<span><i class="fa fa-exclamation-circle"></i></span>
						</li>
					</ul>
					<span>No controllers detected. Try pressing any button.</span>
				</div>
				<span class="clear"></span>
			</div>
		</div>
		<div class="slideout-menu hide-me" id="menu">
			<a class="bglink" href="#"><div class="modal-bg"></div></a>
			<div class="menu">
				<h1><i class="fa fa-gamepad"></i>Controller</h1>
				<ul>
					<li>
						<a href="#about"><i class="fa fa-info-circle"></i><span>Info</span></a>
					</li>
					<li>
						<a href="#docs"><i class="fa fa-file-text"></i><span>Docs</span></a>
					</li>
					<li>
						<a href="#remap"><i class="fa fa-gamepad"></i><span>Remap</span></a>
					</li>
				</ul>
			</div>
		</div>
		<div id="modals" class="hide-me">
			<div id="modal-template" class="modal-container">
				<a class="bglink" href="#"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu">
						<ul>
							<li><a href="#about">Info</a></li>
							<li><a href="#docs">Docs</a></li>
							<li><a href="#remap">Remap</a></li>
						</ul>
					</header>
					<header><a class="close" href="#">&times;</a></header>
				</div>
			</div>
			<div id="about" class="modal-container">
				<a class="bglink" href="#"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu"></header>
					<header>
						<a class="close" href="#">&times;</a>
						<h1>Info & About</h1>
					</header>
					<article>
						<h2>About this tool</h2>
						<p>Locally, offline, reliable.</p>
						<p>
							This is possible thanks to <a href="http://aresluna.org" target="_blank">Marcin Wichary's</a> <a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/content/tutorials/doodles/gamepad/static/gamepad-tester/gamepad.js" target="_blank">Gamepad.js</a> and
							<a href="https://github.com/html5rocks/www.html5rocks.com/blob/master/content/tutorials/doodles/gamepad/static/gamepad-tester/tester.js" target="_blank">Tester.js</a> libraries.
						</p>
						<div class="info">
							<div>
								<h2>Chroma Key Installation</h2>
								<ol>
									<li>Create new window capture source</li>
									<li>Select the window with the gamepad viewer</li>
									<li>Enable "Color Key"</li>
									<li>Next to "Color" click the "Select" button and use the eyedropper tool to select the brown background on the page</li>
									<li>Set the "Similarity" and "Blend" to your desired values</li>
									<li>Enable "Sub-Region"</li>
									<li>Click on "Select Region" and shrink the region box to the desired size</li>
									<li>Click "OK" and you're done!</li>
								</ol>
							</div>
						</div>
					</article>
				</div>
			</div>
			<div id="docs" class="modal-container">
				<a class="bglink" href="#"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu"></header>
					<header>
						<a class="close" href="#">&times;</a>
						<h1>Parameter Documentation</h1>
					</header>
					<article>
						<section class="definition">
							<h2 data-param="p=">Player Number</h2>
							<div class="codeblock">https://gamepadviewer.com/?p=1</div>
							<ul>
								<li>N/A</li>
								<li>1</li>
								<li>1,2,3,4</li>
								<li>Setting this parameter initiates "Compact Mode", which removes the background and UI elements so only the controller is displayed</li>
							</ul>
							<p>The player number parameter is the main method of selecting which connected controller to view in Compact Mode.</p>
						</section>
						<section class="definition">
							<h2 data-param="s=">Skin ID</h2>
							<div class="codeblock">https://gamepadviewer.com/?s=1</div>
							<ul>
								<li>N/A</li>
								<li>1</li>
								<li>0,1,2,3,4,5</li>
								<li>Setting the ID to anything other than the values above defaults the skin to '1', which is the "Xbox One" skin</li>
								<li>Setting a player number (<code class="codeblock">p=</code>) is <strong>required</strong> if you plan on using the skin ID parameter</li>
							</ul>
							<p>Setting a skin ID is the only way to choose what gamepad it is you'd like to display in Compact Mode. If you'd like to use a custom skin, you'll need to read about the <code class="codeblock">css=</code> parameter below.</p>
						</section>
						<section class="definition">
							<h2 data-param="smeter=">Strength Meter</h2>
							<div class="codeblock">https://gamepadviewer.com/?smeter=1</div>
							<ul>
								<li>N/A</li>
								<li>0</li>
								<li>0,1</li>
								<li>Any value other than '1' disables this setting</li>
							</ul>
							<p>When this setting is enabled, the visual representation for the triggers will be strength meters instead of opacity levels.</p>
						</section>
						<section class="definition">
							<h2 data-param="sc=">Scale Multiplier</h2>
							<div class="codeblock">https://gamepadviewer.com/?sc=1.2</div>
							<ul>
								<li>N/A</li>
								<li>1</li>
								<li>Any number, including decimal values</li>
								<li>Negative values simply flip the skin, while also scaling it negatively</li>
							</ul>
							<p>Enabling this setting allows you to scale the gamepad's size using either integer or decimal values.</p>
						</section>
						<section class="definition">
							<h2 data-param="dz=">Deadzone Radius</h2>
							<div class="codeblock">https://gamepadviewer.com/?dz=0.3</div>
							<ul>
								<li>N/A</li>
								<li>.25</li>
								<li>Any number from 0 to 1, including decimal values</li>
								<li>Setting this to 1 or anything greater basically disables the sticks' movement</li>
							</ul>
							<p>This setting is ideal if you have an old gamepad that's experiencing stick drifting, or simply don't want every tiny movement made with the gamepad to be displayed.</p>
						</section>
						<section class="definition">
							<h2 data-param="delay=">Input Delay</h2>
							<div class="codeblock">https://gamepadviewer.com/?delay=2000</div>
							<ul>
								<li>Milliseconds</li>
								<li>0</li>
								<li>Any positive number</li>
							</ul>
							<p>If you capture gameplay from a PS4 and have your controller connected to both the computer and console, this setting is for you. Simply enter the stream delay from the console to your PC in milliseconds and your inputs will be synced, instead of ahead.</p>
						</section>
						<section class="definition">
							<h2 data-param="rot=">Rotational Stop</h2>
							<div class="codeblock">https://gamepadviewer.com/?rot=450</div>
							<ul>
								<li>Degrees</li>
								<li>120</li>
								<li>Any positive number</li>
								<li>This number is half the total rotational stop of the wheel. E.g. A wheel with a 900deg max rotation will have a 450deg rotation stop.</li>
								<li>Deadzone values <strong>WILL</strong> affect this setting. Setting <code class="codeblock">dz=0</code> is recommended.</li>
							</ul>
							<p>This setting is meant mainly for having the thumbsticks represent wheels, with the option to set their max degree of rotation.</p>
						</section>
						<section class="definition">
							<h2 data-param="css=">Custom CSS URL</h2>
							<div class="codeblock">https://gamepadviewer.com/?css=https://gist.githubusercontent.com/mrmcpowned/d61ff0d8d0c57cc207d8/raw/minimal%2520xbox.css</div>
							<ul>
								<li>N/A</li>
								<li>None</li>
								<li>Any URL pointing to a properly formatted CSS file</li>
								<li>This parameter disables the <code class="codeblock">id=</code> parameter</li>
								<li>Whatever the selected skin's CSS class is is replaced with the <code class="codeblock">.custom</code> class</li>
							</ul>
							<p>Using this parameter allows you to completely change the design of the Gamepad Viewer into one of your own or one somebody has shared.</p>
						</section>
						<section class="definition">
							<h2 data-param="editcss=">Edit CSS URL</h2>
							<div class="codeblock">https://gamepadviewer.com/?editcss=https://gist.githubusercontent.com/mrmcpowned/a787fc4f5307b7c008fb/raw/edit%2520example.css</div>
							<ul>
								<li>N/A</li>
								<li>None</li>
								<li>Any URL pointing to a properly formatted CSS file</li>
								<li>The <code class="codeblock">.edit</code> class is applied to all gamepads</li>
							</ul>
							<p>Similar to the <code class="codeblock">css=</code> parameter, you can edit the currently selected skin's css instead of making a completely new skin.</p>
						</section>
					</article>
				</div>
			</div>
			<div id="remap" class="modal-container">
				<a class="bglink" href="#"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu"></header>
					<header>
						<a class="close" href="#">&times;</a>
						<h1>Button Rebinding</h1>
					</header>
					<article>
						<p>
							Please select the controller to use as a mapping base.
							<select id="player-base">
								<option>None</option>
								<option value="0" disabled>Player 1</option>
								<option value="1" disabled>Player 2</option>
								<option value="2" disabled>Player 3</option>
								<option value="3" disabled>Player 4</option>
							</select>
						</p>
						<div id="output-display">
							<div class="raw-outputs template">
								<div>
									<h3>Axes</h3>
									<ul class="axes"></ul>
								</div>
								<div>
									<h3>Buttons</h3>
									<ul class="buttons"></ul>
								</div>
							</div>
						</div>
						<div id="mapping-config">
							<a href="#" id="prepend-mapping" class="map-control"><i class="fa fa-plus-circle"></i> Add New Mapping</a>
							<div class="template">
								<div class="form-group">
									<div class="map-message"></div>
									<input type="radio" name="targetType" value="buttons" checked />
									<input type="radio" name="targetType" value="axes" />
									<input type="radio" name="targetType" value="dpad" />
									<input type="checkbox" class="fa fa-check-square axes-config" value="false" />
									<select name="buttons" value>
										<option title="Button 0" value="0">A/Cross</option>
										<option title="Button 1" value="1">B/Circle</option>
										<option title="Button 2" value="2">X/Square</option>
										<option title="Button 3" value="3">Y/Triangle</option>
										<option title="Button 4" value="4">LB/L1</option>
										<option title="Button 5" value="5">RB/R1</option>
										<option title="Button 6" value="6">LT/L2</option>
										<option title="Button 7" value="7">RT/R2</option>
										<option title="Button 8" value="8">Select/Back</option>
										<option title="Button 9" value="9">Start</option>
										<option title="Button 10" value="10">LS/L3</option>
										<option title="Button 11" value="11">RS/R3</option>
										<option title="Button 12" value="12">D-Pad Up</option>
										<option title="Button 13" value="13">D-Pad Down</option>
										<option title="Button 14" value="14">D-Pad Left</option>
										<option title="Button 15" value="15">D-Pad Right</option>
										<option title="Button 16" value="16">PS Button</option>
										<option title="Button 17" value="17">TouchPad Press</option>
									</select>
									<select name="axes" value>
										<option title="Axis 0" value="0">LS Horizontal</option>
										<option title="Axis 1" value="1">LS Vertical</option>
										<option title="Axis 2" value="2">RS Horizontal</option>
										<option title="Axis 3" value="3">RS Vertical</option>
									</select>
									<input type="checkbox" class="disable-item" value="true" />
									<button data-tooltip="Positive Axis" data-button="positive" data-button-type="remapping" data-object="">Click to Set</button>
									<button data-tooltip="Negative Axis" data-button="negative" data-button-type="remapping" data-object="">Click to Set</button>
									<a href="#" class="fa fa-minus-circle del-config"></a>
									<a href="#" class="fa fa-plus-circle add-config"></a>
									<div class="fix-panel fix-axes">
										<span>Fix Type: </span>
										<select name="fix-type">
											<option value="trigger">Trigger (0 to 1)</option>
											<option value="stick">Stick (-1 to 1)</option>
										</select>
										<button data-tooltip="Lowest Value" data-button="low-value" data-button-type="value">Click to Set Value</button>
										<button data-tooltip="Highest Value" data-button="high-value" data-button-type="value">Click to Set Value</button>
									</div>
									<ul class="fix-panel fix-dpad">
										<li><span>Up: </span><button data-button="up" data-button-type="value">Click to Set Value</button></li>
										<li><span>Down: </span><button data-button="down" data-button-type="value">Click to Set Value</button></li>
										<li><span>Left: </span><button data-button="left" data-button-type="value">Click to Set Value</button></li>
										<li><span>Right: </span><button data-button="right" data-button-type="value">Click to Set Value</button></li>
										<li><span>Up and Right: </span><button data-button="upright" data-button-type="value">Click to Set Value</button></li>
										<li><span>Up and Left: </span><button data-button="upleft" data-button-type="value">Click to Set Value</button></li>
										<li><span>Down and Right: </span><button data-button="downright" data-button-type="value">Click to Set Value</button></li>
										<li><span>Down and Left: </span><button data-button="downleft" data-button-type="value">Click to Set Value</button></li>
									</ul>
								</div>
							</div>
							<div id="mappings"></div>
							<div class="button-group">
								<button id="export-mapping">Export Mapping to URL Generator</button>
								<button id="apply-mapping">Apply Mapping</button>
								<span class="clear"></span>
							</div>
						</div>
					</article>
				</div>
			</div>
		</div>
	</body>
</html>
