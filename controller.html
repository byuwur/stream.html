<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<title>Controller</title>
		<link rel="stylesheet" type="text/css" href="./css/controller.css" />
		<script defer>
			function Queue() {
				let queue = [],
					offset = 0;
				this.getLength = () => queue.length - offset;
				this.isEmpty = () => this.getLength() === 0;
				this.enqueue = (item) => queue.push(item);
				this.dequeue = () => {
					if (this.isEmpty()) return undefined;
					const item = queue[offset++];
					if (offset * 2 >= queue.length) {
						queue = queue.slice(offset);
						offset = 0;
					}
					return item;
				};
				this.peek = () => (this.isEmpty() ? undefined : queue[offset]);
			}
		</script>
		<script src="./js/_jquery1102.min.js" defer></script>
		<script src="./config/controller.keyboard.js" defer></script>
		<script src="./js/controller.gamepad.js" defer></script>
		<script src="./js/controller.tester.js" defer></script>
		<script src="./js/controller.js" defer></script>
	</head>
	<body>
		<div class="container" id="gamepads">
			<div class="template">
				<div class="plshalpme">
					<div><p>Disconnected</p></div>
				</div>
				<div class="triggers">
					<span class="trigger left" data-name="button-left-shoulder-bottom"></span>
					<span class="trigger right" data-name="button-right-shoulder-bottom"></span>
					<span class="trigger-button left" data-name="button-left-shoulder-bottom-digital"></span>
					<span class="trigger-button right" data-name="button-right-shoulder-bottom-digital"></span>
					<span class="clear"></span>
				</div>
				<div class="bumpers">
					<span class="bumper left" data-name="button-left-shoulder-top"></span>
					<span class="bumper right" data-name="button-right-shoulder-top"></span>
					<span class="clear"></span>
				</div>
				<div class="touchpad" data-name="touch-pad"></div>
				<div class="quadrant"></div>
				<div class="meta" data-name="button-meta"></div>
				<div class="arrows">
					<span class="back" data-name="button-select"></span>
					<span class="start" data-name="button-start"></span>
					<span class="clear"></span>
				</div>
				<div class="abxy">
					<span class="button a" data-name="button-1"></span>
					<span class="button b" data-name="button-2"></span>
					<span class="button x" data-name="button-3"></span>
					<span class="button y" data-name="button-4"></span>
				</div>
				<div class="sticks">
					<span class="stick left" data-name="stick-1"></span>
					<span class="stick right" data-name="stick-2"></span>
				</div>
				<div class="wheels">
					<span class="wheel left" data-name="stick-1-wheel"></span>
					<span class="wheel right" data-name="stick-2-wheel"></span>
				</div>
				<div class="dpad">
					<span class="face up" data-name="button-dpad-top"></span>
					<span class="face down" data-name="button-dpad-bottom"></span>
					<span class="face left" data-name="button-dpad-left"></span>
					<span class="face right" data-name="button-dpad-right"></span>
				</div>
				<div class="fstick" data-name="arcade-stick"></div>
			</div>
			<div class="controller xbox disconnected" id="gamepad-0"></div>
			<div class="controller xbox disconnected" id="gamepad-1"></div>
			<div class="controller xbox disconnected" id="gamepad-2"></div>
			<div class="controller xbox disconnected" id="gamepad-3"></div>
			<div class="controller xbox disconnected" id="gamepad-9"></div>
		</div>
		<div class="navbar hide-me">
			<div class="content">
				<div class="left">
					<a href="#menu" title="Menu"><i class="fa fa-bars menu-button"></i></a>
				</div>
				<div class="center pselect">
					<div class="left">
						<span>Player:</span>
						<select class="player" id="pselect" title="Player">
							<option>-</option>
							<option value="gamepad-0">1</option>
							<option value="gamepad-1">2</option>
							<option value="gamepad-2">3</option>
							<option value="gamepad-3">4</option>
							<option value="gamepad-9">KB</option>
						</select>
					</div>
					<div class="left skins">
						<select class="console" id="cselect" title="Console">
							<option value="xbox">Xbox (1)</option>
							<option value="ps">PlayStation (2)</option>
							<option value="fight-stick">Fight Stick (7)</option>
							<option value="gc">GameCube (9)</option>
						</select>
					</div>
				</div>
			</div>
		</div>
		<div class="navbar nocon hide-me">
			<div class="content">
				<div class="left">
					<div class="box alert">
						<span><i class="fa fa-exclamation-circle"></i></span>
					</div>
					<span>No controllers detected. Press ANY Button or [F].</span>
				</div>
			</div>
		</div>
		<div class="slideout-menu hide-me" id="menu">
			<a class="bglink" href="#" title="Close"><div class="modal-bg"></div></a>
			<div class="menu">
				<h1><i class="fa fa-gamepad"></i>Controller</h1>
				<a href="#about"><i class="fa fa-info-circle"></i><span>Info</span></a>
				<a href="#docs"><i class="fa fa-file-text"></i><span>Params</span></a>
				<a href="#remap"><i class="fa fa-gamepad"></i><span>Remap</span></a>
			</div>
		</div>
		<div id="modals" class="hide-me">
			<div id="modal-template" class="modal-container">
				<a class="bglink" href="#" title="Close"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu">
						<a class="close" href="#">&times;</a>
						<ul>
							<li><a href="#about">Info</a></li>
							<li><a href="#docs">Params</a></li>
							<li><a href="#remap">Remap</a></li>
						</ul>
					</header>
				</div>
			</div>
			<div id="about" class="modal-container">
				<a class="bglink" href="#" title="Close"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu"></header>
					<header>
						<h1>Information</h1>
					</header>
					<article>
						<h2>About this tool</h2>
						<p>Locally, offline, reliable. - <a rel="noopener" href="https://byuwur.net" target="_blank">[Mateus] byUwUr</a></p>
						<p>
							This is possible thanks to <a rel="noopener" href="http://aresluna.org" target="_blank">Marcin Wichary's</a> <a rel="noopener" href="https://github.com/html5rocks/www.html5rocks.com/blob/master/content/tutorials/doodles/gamepad/static/gamepad-tester/gamepad.js" target="_blank">Gamepad.js</a> and
							<a rel="noopener" href="https://github.com/html5rocks/www.html5rocks.com/blob/master/content/tutorials/doodles/gamepad/static/gamepad-tester/tester.js" target="_blank">Tester.js</a> libraries.
						</p>
						<h2>Chroma Key Installation with OBS</h2>
						<ol>
							<li>Create new window capture source, then select this window.</li>
							<li>Enable "Color Key" in the source's filters. Set it up as you like.</li>
							<li>By then you should be already done!</li>
						</ol>
					</article>
				</div>
			</div>
			<div id="docs" class="modal-container">
				<a class="bglink" href="#" title="Close"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu"></header>
					<header>
						<h1>Parameters</h1>
					</header>
					<article>
						<section class="definition">
							<h2 data-param="p=">Player Number</h2>
							<div class="codeblock">/?p=1</div>
							<ul>
								<li>N/A</li>
								<li>1</li>
								<li>0 (P1), 1 (P2), 2 (P3), 3 (P4), 9 (KB)</li>
								<li>Enables "Lite Mode", displaying only the controller.</li>
							</ul>
							<p>Selects which controller to view in Lite Mode.</p>
						</section>
						<section class="definition">
							<h2 data-param="s=">Skin ID</h2>
							<div class="codeblock">/?s=1</div>
							<ul>
								<li>N/A</li>
								<li>1</li>
								<li>1 (Xbox), 2 (Sony), 7 (Stick), 9 (GCN)</li>
								<li>Defaults to '1' (Xbox) if set to other values.</li>
								<li>Requires a player number (<code class="codeblock">p=</code>).</li>
							</ul>
							<p>Sets the gamepad skin in Lite Mode. For custom skins, see <code class="codeblock">css=</code>.</p>
						</section>
						<section class="definition">
							<h2 data-param="smeter=">Strength Meter</h2>
							<div class="codeblock">/?smeter=1</div>
							<ul>
								<li>N/A</li>
								<li>0</li>
								<li>0,1</li>
								<li>Any value other than '1' disables this setting.</li>
							</ul>
							<p>Enables strength meters for triggers instead of opacity levels.</p>
						</section>
						<section class="definition">
							<h2 data-param="sc=">Scale Multiplier</h2>
							<div class="codeblock">/?sc=1.2</div>
							<ul>
								<li>N/A</li>
								<li>1</li>
								<li>Any number, including decimals.</li>
								<li>Negative values flip and scale the skin.</li>
							</ul>
							<p>Scales the gamepad size using integer or decimal values.</p>
						</section>
						<section class="definition">
							<h2 data-param="dz=">Deadzone Radius</h2>
							<div class="codeblock">/?dz=0.3</div>
							<ul>
								<li>N/A</li>
								<li>.25</li>
								<li>Any number from 0 to 1, including decimals.</li>
								<li>Setting to 1 or higher disables stick movement.</li>
							</ul>
							<p>Ideal for reducing stick drift or ignoring tiny movements.</p>
						</section>
						<section class="definition">
							<h2 data-param="delay=">Input Delay</h2>
							<div class="codeblock">/?delay=2000</div>
							<ul>
								<li>milliseconds</li>
								<li>0</li>
								<li>Any positive number</li>
							</ul>
							<p>Syncs inputs with stream delay when connected to both PC and console.</p>
						</section>
						<section class="definition">
							<h2 data-param="rot=">Rotational Stop</h2>
							<div class="codeblock">/?rot=450</div>
							<ul>
								<li>Degrees</li>
								<li>120</li>
								<li>Any positive number</li>
								<li>Half the total rotational stop of the wheel.</li>
								<li>Deadzone values affect this setting. Set <code class="codeblock">dz=0</code>.</li>
							</ul>
							<p>Sets max rotation for thumbsticks representing wheels.</p>
						</section>
						<section class="definition">
							<h2 data-param="css=">Custom CSS URL</h2>
							<div class="codeblock">/?css=https://byuwur.net/your_file.css</div>
							<ul>
								<li>N/A</li>
								<li>None</li>
								<li>Any URL pointing to a properly formatted CSS file.</li>
								<li>Disables the <code class="codeblock">id=</code> parameter.</li>
								<li>Replaces the selected skin's CSS class with <code class="codeblock">.custom</code>.</li>
							</ul>
							<p>Changes the design with a custom or shared CSS.</p>
						</section>
						<section class="definition">
							<h2 data-param="editcss=">Edit CSS URL</h2>
							<div class="codeblock">/?editcss=https://byuwur.net/your_file.css</div>
							<ul>
								<li>N/A</li>
								<li>None</li>
								<li>Any URL pointing to a properly formatted CSS file.</li>
								<li>Applies the <code class="codeblock">.edit</code> class to all gamepads.</li>
							</ul>
							<p>Edits the current skin's CSS instead of creating a new one.</p>
						</section>
					</article>
				</div>
			</div>
			<div id="remap" class="modal-container">
				<a class="bglink" href="#" title="Close"><div class="modal-bg"></div></a>
				<div class="modal">
					<header class="minimenu"></header>
					<header>
						<h1>Remapping</h1>
					</header>
					<article>
						<p>
							Please select the controller:
							<select id="player-base" title="Player">
								<option selected>-</option>
								<option value="0" disabled>1</option>
								<option value="1" disabled>2</option>
								<option value="2" disabled>3</option>
								<option value="3" disabled>4</option>
								<option value="9" disabled>KB</option>
							</select>
						</p>
						<div id="output-display">
							<div class="raw-outputs template">
								<div>
									<h3>Axes</h3>
									<ul class="axes"></ul>
								</div>
								<div>
									<h3>Buttons</h3>
									<ul class="buttons"></ul>
								</div>
							</div>
						</div>
						<div id="mapping-config">
							<a href="#" id="prepend-mapping" class="map-control"><i class="fa fa-plus-circle"></i> Add New Mapping</a>
							<div class="template">
								<div class="form-group">
									<div class="map-message"></div>
									<input type="radio" name="targetType" value="buttons" title="Buttons" checked />
									<input type="radio" name="targetType" value="axes" title="Axes" />
									<input type="radio" name="targetType" value="dpad" title="D-Pad" />
									<input type="checkbox" class="axes-config" value="false" title="Axes configuration" />
									<select name="buttons" title="Buttons">
										<option title="Button 0" value="0">A/Cross</option>
										<option title="Button 1" value="1">B/Circle</option>
										<option title="Button 2" value="2">X/Square</option>
										<option title="Button 3" value="3">Y/Triangle</option>
										<option title="Button 4" value="4">LB/L1</option>
										<option title="Button 5" value="5">RB/R1</option>
										<option title="Button 6" value="6">LT/L2</option>
										<option title="Button 7" value="7">RT/R2</option>
										<option title="Button 8" value="8">Select/Back</option>
										<option title="Button 9" value="9">Start</option>
										<option title="Button 10" value="10">LS/L3</option>
										<option title="Button 11" value="11">RS/R3</option>
										<option title="Button 12" value="12">D-Pad Up</option>
										<option title="Button 13" value="13">D-Pad Down</option>
										<option title="Button 14" value="14">D-Pad Left</option>
										<option title="Button 15" value="15">D-Pad Right</option>
										<option title="Button 16" value="16">PS Button</option>
										<option title="Button 17" value="17">TouchPad Press</option>
									</select>
									<select name="axes" title="Axes">
										<option title="Axis 0" value="0">LS Horizontal</option>
										<option title="Axis 1" value="1">LS Vertical</option>
										<option title="Axis 2" value="2">RS Horizontal</option>
										<option title="Axis 3" value="3">RS Vertical</option>
									</select>
									<input type="checkbox" class="disable-item" value="true" title="Disable" />
									<button data-tooltip="Positive Axis" data-button="positive" data-button-type="remapping" data-object="">Click to Set</button>
									<button data-tooltip="Negative Axis" data-button="negative" data-button-type="remapping" data-object="">Click to Set</button>
									<a title="Add" href="#" class="fa fa-minus-circle del-config"></a>
									<a title="Remove" href="#" class="fa fa-plus-circle add-config"></a>
									<div class="fix-panel fix-axes">
										<span>Fix Type: </span>
										<select name="fix-type" title="Type">
											<option value="trigger">Trigger (0 to 1)</option>
											<option value="stick">Stick (-1 to 1)</option>
										</select>
										<button data-tooltip="Lowest Value" data-button="low-value" data-button-type="value">Click to Set Value</button>
										<button data-tooltip="Highest Value" data-button="high-value" data-button-type="value">Click to Set Value</button>
									</div>
									<ul class="fix-panel fix-dpad">
										<li><span>Up: </span><button data-button="up" data-button-type="value">Click to Set Value</button></li>
										<li><span>Down: </span><button data-button="down" data-button-type="value">Click to Set Value</button></li>
										<li><span>Left: </span><button data-button="left" data-button-type="value">Click to Set Value</button></li>
										<li><span>Right: </span><button data-button="right" data-button-type="value">Click to Set Value</button></li>
										<li><span>Up and Right: </span><button data-button="upright" data-button-type="value">Click to Set Value</button></li>
										<li><span>Up and Left: </span><button data-button="upleft" data-button-type="value">Click to Set Value</button></li>
										<li><span>Down and Right: </span><button data-button="downright" data-button-type="value">Click to Set Value</button></li>
										<li><span>Down and Left: </span><button data-button="downleft" data-button-type="value">Click to Set Value</button></li>
									</ul>
								</div>
							</div>
							<div id="mappings"></div>
							<div class="button-group">
								<button id="apply-mapping">Apply Mapping</button>
								<span class="clear"></span>
							</div>
						</div>
					</article>
				</div>
			</div>
		</div>
	</body>
</html>
